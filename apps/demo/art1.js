/* globals cpcBasic */

"use strict";

cpcBasic.addItem("", function () { /*
1 rem art1 - Art 1: Screens Unlimited
2 rem
3 rem https://www.cpcwiki.eu/forum/programming/basic-files/ (BASIC02.DSK)
4 rem TODO: call &7800
5 rem
10 DEFINT a-z:pai=0
20 RANDOMIZE TIME:DIM qnk(16):ccc=48:nk%=0:lt$="-A"
30 FOR n=0 TO 13:READ b:POKE &7800+n,b:NEXT n
40 DATA &dd,&7e,&00,&cd,&35,&bc,&dd,&6e,&02,&dd,&66,&03,&70,&c9
50 MASK 255,0:BORDER 0:GOSUB 1130:ON ch GOSUB 5170,1920,2310,3510,5170,5180: REM MENU 1
60 SPEED KEY 30,2
70 a$=INKEY$:IF a$="" THEN GOTO 60
80 IF a$=CHR$(224)THEN GOTO 3450
90 IF a$=CHR$(13) THEN CLS:GOTO 50
100 GOTO 70
110 a=INT(RND(2)*420)
120 b=INT(RND(2)*200)+60:c=a+b:MOVE a,cst,4:DRAWR c,0:MOVE a,cst
130 FOR n=1 TO INT(b/16):GRAPHICS PEN 4:q=INT(RND(2)*3)+1
140 DRAWR 4,q:NEXT
150 FOR n=1 TO INT(b/16):GRAPHICS PEN 4:q=INT(RND(2)*2)+1:DRAWR 4,-q:NEXT
160 DRAWR 2,0:DRAW a+c,cst
170 MOVE a+(b/2),cst+3:FILL 4
180 RETURN
190 IF pai=1 THEN GRAPHICS PEN 0 ELSE GRAPHICS PEN 11
200 IF pai=1 THEN st2=st-35:of2=60 ELSE st2=st-50:of2=50
210 FOR n=0 TO 639 STEP 4
220 a=INT(RND(2)*2)
230 IF a=0 THEN of2=of2-1 ELSE of2=of2+1
240 IF of2<=0 THEN RETURN ELSE MOVE n,st2:DRAW n,st2+of2
250 NEXT:GRAPHICS PEN 1:RETURN
260 c=INT(RND(2)*200)+220:s=INT(RND(2)*30)+20:u=INT(RND(2)*50)+20:sun=c:sz=s
270 IF ch=1 THEN u=75
280 ORIGIN c,dst+u
290 DEG:GRAPHICS PEN 5:IF pai=1 THEN GRAPHICS PEN 1
300 MOVER 0,s
310 FOR a=0 TO 360 STEP 5
320 DRAW s*SIN(a),s*COS(a):NEXT
330 MOVER 1,-10:FILL 5:ORIGIN 0,0:GRAPHICS PEN 1:RETURN
340 v=INT(RND(2)*3):IF v=1 THEN GOSUB 1740: RETURN
350 IF v=2 THEN GOSUB 2850:RETURN
360 FOR cst=350 TO st+16 STEP -30:GOSUB 370:NEXT cst:RETURN
370 GRAPHICS PEN 4:cl=cst:ocl=3:n=0
380 IF pai=1 THEN GRAPHICS PEN 1:MASK 170,0
390 q=INT(RND(2)*15)+5
400 n=n+q:IF n>=639 THEN RETURN
410 a=INT(RND(2)*2)
420 IF a=0 THEN ocl=ocl-2 ELSE ocl=ocl+2
430 IF ocl<=0 THEN GOTO 400 ELSE MOVE n,cl:DRAW n,cl+ocl
440 n=n+4:IF n>=639 THEN GRAPHICS PEN 1:RETURN
450 GOTO 410
460 GRAPHICS PEN 12:st3=st2-20:of3=15:ip=4
470 IF pai=1 THEN st3=st2-30:of3=20:MASK 153:ip=1:GRAPHICS PEN 1
480 FOR n=0 TO 639 STEP ip
490 a=INT(RND(2)*2)
500 IF a=0 THEN of3=of3-1 ELSE of3=of3+1
510 IF of3<=0 THEN RETURN ELSE MOVE n,st3:DRAW n,st3+of3
520 NEXT:GRAPHICS PEN 1:RETURN
530 FOR rd=0 TO 125
540 c=INT(RND(2)*3)+8:GRAPHICS PEN c
550 IF pai=1 THEN GRAPHICS PEN 1:MASK 85
560 x=INT(RND(2)*639):y=INT(RND(2)*st2)
570 MOVE x,y:FOR n=1 TO 6:DRAWR n*2,0:MOVE x-n,y-n:NEXT n
580 NEXT rd:RETURN
590 MASK 255,0:GOSUB 1210:MODE 0:BORDER 3:ON ch GOSUB 950,950,1000,1030,1010,1080
600 IF pai=1 THEN MODE 2:INK 0,26:INK 1,0:IF ch=5 OR ch=6 THEN INK 0,0:INK 1,26
610 IF pai=1 AND ch=4 THEN INK 0,16:INK 1,0
620 GRAPHICS PEN 1:st=INT(RND(2)*100)+100:dst=st+70:cst=350
630 PLOT 0,st:DRAW 639,st:MOVE 0,st+5:IF pai=1 THEN FILL 0 ELSE FILL 2
640 MASK 255
650 PLOT 0,st-50:DRAW 639,st-50:MOVE 0,st-15:FILL 7:MOVE 0,st-55:FILL 3
660 MASK 255
670 IF ch=5 THEN qq=INT(RND(2)*2):IF qq=0 THEN GOSUB 850:GOTO 700 ELSE GOTO 680
680 IF ch<>3 THEN GOSUB 260
690 IF ch=1 OR ch=6 THEN GOTO 700 ELSE GOSUB 340
700 a=INT(RND(2)*50)+50:ht=st+a
710 IF pai=1 THEN ip=1 ELSE ip=4
720 MOVE 0,st:MASK 255,0
730 FOR n=0 TO 639 STEP ip:GRAPHICS PEN 1
740 a=INT(RND(2)*2)
750 IF a=0 THEN of=1 ELSE of=-1
760 ht=ht+of:MOVE n,st:DRAW n,ht:NEXT
770 GOSUB 190
780 IF st>120 THEN GOSUB 460
790 GOSUB 530
800 IF pai=1 THEN MASK 85
810 u=INT(RND(2)*5)+1:ON u GOSUB 1430,1530,1590,1600,1660
820 GOSUB 1300
830 IF ch=6 THEN GOSUB 1500
840 BORDER 0:RETURN
850 cl=INT(RND(2)*5):IF cl=0 THEN c=13
860 IF cl=1 THEN c=25
870 IF cl=2 THEN c=24
880 IF cl=3 THEN c=14
890 IF cl=4 THEN c=16
900 FOR n=1 TO 150
910 x=INT(RND(2)*640):y=INT(RND(2)*(400-st))+(st+4)
920 INK 14,c:GRAPHICS PEN 14
930 IF pai=1 THEN GRAPHICS PEN 1
940 MASK 1,0:PLOT x,y:NEXT n:MASK 255,0:RETURN
950 INK 0,0:INK 2,11:INK 3,9:INK 1,10:INK 4,26:INK 5,24:INK 6,0:INK 7,2:INK 8,18:INK 9,0:INK 10,21:INK 11,12:INK 12,13:INK 13,18:INK 14,16:INK 15,26:GRAPHICS PEN 1:REM SUMMERS DAY
960 z=INT(RND(2)*3):IF z=0 THEN c=11
970 IF z=1 THEN c=14:INK 5,25 
980 IF z=2 THEN c=20:INK 5,19
990 INK 2,c:RETURN
1000 INK 0,0:INK 2,13:INK 3,9:INK 1,10:INK 4,23:INK 5,24:INK 6,0:INK 7,14:INK 8,0:INK 9,13:INK 10,19:INK 11,0:INK 12,10:INK 13,18:INK 14,11:INK 15,25:RETURN
1010 INK 0,0:INK 2,1:INK 3,1:INK 1,0:INK 4,13:INK 5,25:INK 6,0:INK 7,5:INK 8,9:INK 9,0:INK 10,3:INK 11,9:INK 12,0:INK 13,12:INK 14,5:INK 15,24
1020 RETURN
1030 INK 0,0:INK 2,16:INK 3,9:INK 1,10:INK 4,17:INK 5,6:INK 6,0:INK 7,5:INK 8,0:INK 9,0:INK 10,3:INK 11,4:INK 12,0:INK 13,20:INK 14,16:INK 15,26
1040 q=INT(RND(2)*4):IF q=0 THEN RETURN
1050 IF q=1 THEN INK 2,15:INK 4,24:INK 1,0:INK 3,9:INK 9,25:INK 8,3:INK 10,6:RETURN
1060 IF q=2 THEN INK 2,17:INK 5,15:INK 4,8:RETURN
1070 IF q=3 THEN INK 2,25:INK 5,15:INK 4,6:INK 1,0:INK 12,1:RETURN
1080 INK 0,0:INK 2,10:INK 3,26:INK 1,26:INK 4,13:INK 5,15:INK 6,0:INK 7,14:INK 8,0:INK 9,9:INK 10,3:INK 11,0:INK 12,13:INK 13,21:INK 14,15:INK 15,24
1090 qw=INT(RND(2)*3):IF qw=0 THEN RETURN
1100 IF qw=1 THEN INK 2,13:INK 12,10:INK 5,6:RETURN
1110 IF qw=2 THEN INK 5,16:cd=16:INK 2,1:sk=1:INK 10,6:RETURN
1120 RETURN
1130 MODE 1:BORDER 5:INK 0,0:INK 1,26:INK 2,11:INK 3,6: WINDOW#1,5,35,3,22:PAPER #1,2:CLS#1
1140 LOCATE#1,8,2:PAPER #1,1:PEN #1,0:PRINT#1,"SCREENS UNLIMITED"
1150 LOCATE #1,9,5:PAPER#1,1:PEN#1,3:PRINT#1,"1) - LANDSCAPE":LOCATE #1,9,7:PRINT#1,"2) - GALAXIA"
1160 LOCATE #1,9,9:PRINT #1,"3) - SEASCAPE":LOCATE #1,9,11:PRINT#1,"4) - ABSTRACTS":LOCATE#1,9,13:PRINT #1,"5) - PEN AND INK":LOCATE#1,9,15:PRINT#1,"6) - ADD TEXT"
1170 LOCATE #1,4,18:PAPER#1,0:PEN #1,1:PRINT #1," ENTER NUMBER TO CHOOSE "
1180 a$=INKEY$:IF a$="" THEN 1180
1190 ch=VAL(a$):IF ch<1 OR ch>6 THEN 1180
1200 RETURN
1210 INK 3,7:WINDOW #2,8,38,6,24:PAPER #2,3:CLS #2
1220 LOCATE #2,9,2:PAPER #2,0:PEN #2,2:PRINT #2," LANDSCAPE TYPE "
1230 LOCATE #2,9,5:PAPER #2,1:PEN #2,0:PRINT #2,"1) - SUNNY WEATHER":LOCATE #2,9,7:PRINT #2,"2) - BRIGHT WEATHER":LOCATE #2,9,9:PRINT #2,"3) - CLOUDY AND DULL"
1240 LOCATE #2,9,11:PRINT #2,"4) - SUNSET":LOCATE #2,9,13:PRINT #2,"5) - NIGHT":LOCATE #2,9,15:PRINT #2,"6) - WINTER SNOW"
1250 LOCATE #2,5,18:PAPER#2,0:PEN #2,2:PRINT #2," ENTER NUMBER TO CHOOSE "
1260 a$=INKEY$:IF a$="" THEN 1260
1270 IF ASC(a$)<49 OR ASC(a$) >54 THEN 1260
1280 ch=VAL(a$):IF ch<1 OR ch>6 THEN 1260
1290 RETURN
1300 zz=INT(RND(2)*7)+4
1310 FOR q=1 TO zz:x=INT(RND(2)*600)+10:y=INT(RND(2)*st2)
1320 c=INT(RND(2)*3)+8:GRAPHICS PEN c
1330 GOSUB 1340:NEXT q:RETURN
1340 MOVE x,y:GRAPHICS PEN c:DRAWR 0,132:MOVER -4,-4:DRAWR 8,0:MOVER -8,-4:DRAWR 8,0
1350 MOVER -8,-4:DRAWR 8,0:MOVER -8,-4:DRAWR 8,0
1360 MOVER -4,-6:DRAWR 12,6:MOVER -24,0:DRAWR 12,-6
1370 MOVER 0,-6:DRAWR 12,6:MOVER -24,0:DRAWR 12,-6:MOVER 0,-6:DRAWR 16,6:MOVER -32,0:DRAWR 16,-6:MOVER 0,-6:DRAWR 16,6:MOVER -32,0:DRAWR 16,-6
1380 MOVER 0,-6:DRAWR 16,6:MOVER -32,0:DRAWR 16,-6:MOVER 0,-6:DRAWR 16,6:MOVER -32,0:DRAWR 16,-6
1390 FOR n=1 TO 3:MOVER 0,-6:DRAWR 20,8:MOVER -40,0:DRAWR 20,-8:NEXT
1400 FOR n=1 TO 3:MOVER 0,-6:DRAWR 24,8:MOVER -48,0:DRAWR 24,-8:NEXT
1410 FOR n=1 TO 3:MOVER 0,-6:DRAWR 28,8:MOVER -56,0:DRAWR 28,-8:NEXT
1420 FOR n=1 TO 3:MOVER 0,-6:DRAWR 36,8:MOVER -72,0:DRAWR 36,-8:NEXT:RETURN
1430 zz=INT(RND(2)*7)+4:p=0:pp=14:IF pai=1 THEN p=1:pp=0:MASK 85
1440 FOR q=1 TO zz:x=INT(RND(2)*600)+20:y=INT(RND(2)*st2)
1450 MOVE x,y:GRAPHICS PEN p
1460 FOR w=1 TO 12:DRAWR 50,0:MOVER -50,1:NEXT w:MOVE x,y-1:GRAPHICS PEN pp:FOR w=1 TO 16:DRAWR 50,0:MOVER -50,-1:NEXT w
1470 IF pai=1 THEN GRAPHICS PEN 1 ELSE GRAPHICS PEN 1
1480 MOVE x+10,y-5:FOR w=1 TO 5:DRAWR 8,0:MOVER 16,0:DRAWR 8,0:MOVER -32,-1:NEXT w
1490 NEXT q:RETURN
1500 GRAPHICS PEN 3:INK 3,26:FOR qq=1 TO 850
1510 x=INT(RND(2)*640):y=INT(RND(2)*400)
1520 PLOT x,y:NEXT qq:RETURN
1530 zz=INT(RND(2)*5)+2
1540 FOR w=1 TO zz:x=INT(RND(2)*600)+20:y=INT(RND(2)*st2):p=14:pp=6:IF pai=1 THEN p=0:pp=1
1550 MOVE x,y,p:FOR qq=1 TO 24:DRAWR 32,0:MOVER -32,-1:NEXT qq:MOVER -4,24,6:FOR qq=0 TO 8:DRAWR 40-(qq*4),0:MOVER -(40-(qq*4)-2),1:NEXT qq
1560 MOVE x+34,y-12,pp:DRAWR 12,0:MOVER -12,-1,14:FOR qq=1 TO 11:DRAWR 12,0:MOVER -12,-1:NEXT qq:MOVE x+36,y-14,6:DRAWR 0,-10:MOVER 12,10:DRAWR 0,-10
1570 MOVE x+4,y-4,pp:FOR qq=1 TO 8:DRAWR 8,0:MOVER 8,0:DRAWR 8,0:MOVER -24,-1:NEXT qq:MOVE x+15,y-23:FOR qq=1 TO 9:DRAWR 4,0:MOVER -4,1:NEXT qq
1580 NEXT w:RETURN
1590 GOSUB 1430:GOSUB 1530:RETURN
1600 x=INT(RND(2)*600)+20:y=INT(RND(2)*st2)+16:p=6:pp=15:IF pai=1 THEN p=1:pp=0
1610 MOVE x,y,pp:FOR qq=1 TO 20:DRAWR 0,64:MOVER 1,-64:NEXT qq:FOR qq=1 TO 24:DRAWR 48,0:MOVER -48,1:NEXT qq
1620 MASK 255:MOVE x,y+64,p:FOR qq=1 TO 4:PLOTR 0,0:PLOTR 0,1:MOVER 8,-1:NEXT qq:MOVE x,y+60:FOR qq=1 TO 2:DRAWR 20,0:MOVER -20,2:NEXT qq:MOVE x+24,y+24:FOR qq=1 TO 12:DRAWR 44,0:MOVER -44,1:NEXT qq 
1630 MOVE x+4,y+48:DRAWR 12,0:MOVER -7,6:DRAWR 0,-16:MOVE x+8,y:FOR qq=1 TO 8:DRAWR 0,16:MOVER 1,-16:NEXT qq
1640 MOVER 8,16:FOR qq=1 TO 8:DRAWR 8,0:MOVER 8,0:DRAWR 8,0:MOVER 8,0:DRAWR 8,0:MOVER -40,-1:NEXT qq
1650 RETURN
1660 GOSUB 1600:GOSUB 1430:RETURN
1670 GRAPHICS PEN bc
1680 a=INT(RND(2)*50)+50:ht=pp+a:MOVE 0,pp
1690 FOR n=0 TO 639 STEP 4:GRAPHICS PEN bc:a=INT(RND(2)*2)
1700 IF a=0 THEN of=8 ELSE of=-10
1710 ht=ht+of:IF ht<pp THEN ht=pp
1720 MOVE n,pp:DRAW n,ht:NEXT
1730 RETURN
1740 FOR w=st+16 TO 400 STEP 4:x=INT(RND(2)*320):y=INT(RND(2)*(600-x)):z=INT(RND(2)*3)
1750 GOTO 1770
1760 IF z=0 OR z>2 THEN GOTO 1790
1770 IF pai=1 THEN GRAPHICS PEN 1:MASK 170 ELSE GRAPHICS PEN 4
1780 MOVE x,w:DRAWR y,0:DRAWR -y,1: DRAWR y,1
1790 NEXT w:RETURN
1800 a=INT(RND(2)*50)+50:ht=pp+a
1810 MOVE 0,pp
1820 FOR n=0 TO 639 STEP 4:GRAPHICS PEN bc
1830 a=INT(RND(2)*2)
1840 IF a=0 THEN of=1 ELSE of=-1
1850 ht=ht+of:MOVE n,pp:DRAW n,ht:NEXT
1860 RETURN
1870 GRAPHICS PEN bc:MOVE 0,pp:FOR w=0 TO 639 STEP 4:qy=INT(RND(2)*100)+50:DRAWR 0,qy:MOVER 4,-qy:NEXT w:RETURN
1880 IF qc=0 THEN RETURN
1890 IF qc=1 THEN INK 15,6,7
1900 IF qc=2 THEN INK 15,16,14
1910 RETURN
1920 BORDER 12:REM GALACTIC LANDSCAPES
1930 MODE 0:INK 0,0:INK 1,3:INK 2,1:INK 3,4:INK 4,26:INK 5,6:INK 6,7:INK 7,8:INK 8,24:INK 9,10:INK 10,14:INK 11,15:INK 12,16:INK 13,17:INK 14,21:INK 15,24,26
1940 c=INT(RND(2)*4):d=INT(RND(2)*14)+1
1950 e=c+d:IF e>14 THEN e=14
1960 GRAPHICS PEN 4:st=INT(RND(2)*100)+100:PLOT 0,st:DRAW 639,st:bst=st-100:PLOT 0,bst:DRAW 639,bst:MOVE 0,st+2:FILL c:MOVE 0,bst+2:FILL d:MOVE 0,bst-2:FILL e
1970 qc=INT(RND(2)*3):GOSUB 1880:FOR ww=1 TO 200:x=INT(RND(2)*639):y=INT(RND(2)*(400-st))+st:PLOT x,y,15:NEXT ww
1980 qw=INT(RND(2)*3)+2:FOR xyz=1 TO qw
1990 x=INT(RND(2)*500)+50:y=INT(RND(2)*100)+st+100:s=INT(RND(2)*50)+20:cc=INT(RND(2)*5)+10
2000 ORIGIN 0,0:DEG
2010 FOR w=1 TO 360 STEP 4:MOVE x,y,cc:DRAW x+s*COS(w),y+s*SIN(w):NEXT w
2020 ORIGIN x,y:GRAPHICS PEN 4:DEG:FOR tt=0 TO 360 STEP 10:DRAW s*2*SIN(tt),(s/10)*COS(tt):NEXT tt:ORIGIN 0,0:MOVE x-(s*2),y:DRAWR s*4,0
2030 NEXT xyz:qq=INT(RND(2)*5)+2
2040 FOR xyz=1 TO qq:x=INT(RND(2)*500)+50:y=INT(RND(2)*(400-st))+st+50:s=INT(RND(20)*10)+10:cc=INT(RND(2)*10)+5
2050 FOR w=1 TO 360 STEP 12:MOVE x,y,cc:DRAW x+s*COS(w),y+s*SIN(w):NEXT w:NEXT xyz
2060 ty=INT(RND(2)*2):IF ty=1 THEN GOSUB 2160:GOTO 2130
2070 IF c=0 THEN bc=1:dc=2:vc=0
2080 IF c=1 THEN bc=3:dc=0:vc=1
2090 IF c=2 THEN bc=0:dc=3:vc=2
2100 IF c=3 THEN bc=0:dc=1:vc=5
2110 tp=INT(RND(2)*3)+1:pp=st:ON tp GOSUB 1800,1670,1870
2120 tp=INT(RND(2)*3)+1:bc=vc:pp=bst:ON tp GOSUB 1800,1870,1670
2130 bc=dc
2140 tp=INT(RND(2)*3)+1:pp=0:ON tp GOSUB 1670,1800,1670
2150 BORDER 13:RETURN
2160 x=0:MASK 170,1
2170 y=bst:wt=INT(RND(2)*30)+20:ht=INT(RND(2)*150)+80:cc=INT(RND(2)*10)+5
2180 MOVE x,y:FOR w=1 TO wt STEP 4:GRAPHICS PEN cc:DRAWR 0,ht:MOVER 4,-ht:NEXT w
2190 x=x+w:IF x<639 THEN 2170
2200 MASK 255,0:RETURN
2210 INK 3,17:WINDOW #2,8,38,6,24:PAPER #2,3:CLS #2
2220 LOCATE #2,9,2:PAPER #2,0:PEN #2,2:PRINT #2," SEASCAPE TYPE "
2230 LOCATE #2,9,4:PAPER #2,1:PEN #2,0:PRINT #2,"1) - SUNNY WEATHER":LOCATE #2,9,6:PRINT #2,"2) - BRIGHT WEATHER":LOCATE #2,9,8:PRINT #2,"3) - STORMY WEATHER"
2240 LOCATE #2,9,10:PRINT #2,"4) - SUNSET":LOCATE #2,9,12:PRINT #2,"5) - NIGHT":LOCATE #2,9,14:PRINT #2,"6) - WINTER SNOW"
2250 LOCATE #2,9,16:PRINT#2,"7) - COASTAL SCENE"
2260 LOCATE #2,5,18:PAPER#2,0:PEN #2,2:PRINT #2," ENTER NUMBER TO CHOOSE "
2270 a$=INKEY$:IF a$="" THEN 2270
2280 IF ASC(a$)<49 OR ASC(a$) >55 THEN 2280
2290 ch=VAL(a$):IF ch<1 OR ch>7 THEN 2270
2300 RETURN
2310 GOSUB 2210:MODE 0:BORDER 3:ON ch GOSUB 950,950,1000,1030,1010,1080,950:IF ch=7 THEN GOTO 3340
2320 INK 1,9
2330 IF ch=3 THEN INK 7,1:INK 1,0:INK 4,10
2340 IF ch=4 THEN INK 1,0
2350 IF ch>4 THEN INK 7,10:INK 1,0
2360 IF ch=5 THEN INK 7,1:INK 2,1:INK 1,0
2370 GRAPHICS PEN 1:st=INT(RND(2)*100)+100:dst=st+70:cst=350
2380 PLOT 0,st:DRAW 639,st:MOVE 0,st+5:FILL 2
2390 MOVE 0,st-5:FILL 7
2400 IF ch=5 THEN qq=INT(RND(2)*2):IF qq=0 THEN GOSUB 850:GOTO 2430 ELSE GOTO 2410
2410 IF ch<>3 THEN GOSUB 260
2420 IF ch=1 OR ch=6 THEN GOTO 2430 ELSE GOSUB 340
2430 land=INT(RND(2)*3):IF land=1 THEN 2550
2440 ot=INT(RND(2)*6):ht=st+ot
2450 MOVE 0,st
2460 GRAPHICS PEN 1:n=0
2470 IF ch=6 THEN INK 1,26
2480 a=INT(RND(2)*2)
2490 IF a=0 THEN of=2 ELSE of=-3
2500 ht=ht+of:IF ht<st THEN n=n+INT(RND(2)*50)+25:ht=st+ot:GOTO 2530
2510 PLOT n,st:DRAW n,ht
2520 n=n+4
2530 IF n>639 THEN 2550
2540 GOTO 2480
2550 REM REFLECTIONS
2560 sk=2:cd=4
2570 IF ch=2 OR ch=1 THEN cd=14:INK 14,5
2580 ta=INT(st/4):tb=ta*2:tc=ta*3
2590 y=st-4 
2600 FOR x=0 TO 639 STEP 4
2610 sy=INT(RND(2)*3):IF sy=1 THEN GRAPHICS PEN cd ELSE GRAPHICS PEN sk
2620 IF sy=2 AND ch<3 THEN GRAPHICS PEN 5
2630 a=INT(RND(2)*4):IF a<2 THEN 2640 ELSE PLOT x,y
2640 NEXT x
2650 IF y<=0 THEN GOTO 2710
2660 IF y<ta THEN y=y-24
2670 IF y>=ta AND y<tb THEN y=y-20
2680 IF y>=tb AND y<tc THEN y=y-12
2690 IF y>=tc THEN y=y-8
2700 GOTO 2600
2710 y=st-8:IF ch=5 AND qq=0 THEN GOTO 2800
2720 IF ch<4 GOTO 2800
2730 GRAPHICS PEN 5
2740 size=INT(sz/4)
2750 FOR x=0 TO size STEP 4
2760 a=INT(RND(2)*4):IF a>1 THEN 2770 ELSE PLOT sun+x,y:PLOT sun-x,y
2770 NEXT x
2780 y=y-6:IF y<=et THEN GOTO 2790 ELSE size=size+4:GOTO 2750
2790 IF ch=6 THEN GOSUB 1500
2800 w=INT(RND(2)*2):IF w=1 THEN vv=tc:GOSUB 2970
2810 w=INT(RND(2)*2):IF w=1 THEN vv=tb:GOSUB 2970
2820 v=INT(RND(2)*10)+2:FOR w=0 TO v:GOSUB 3090:NEXT w
2830 IF ch<5 THEN GOSUB 3260
2840 BORDER 0:RETURN
2850 FOR cst=350 TO st+16 STEP -50:GOSUB 2860:NEXT cst:RETURN
2860 GRAPHICS PEN 4:ocl=3:n=0
2870 IF pai=1 THEN GRAPHICS PEN 1:MASK 153,0
2880 IF ch<3 OR ch=7 THEN INK 4,13
2890 q=INT(RND(2)*15)+5
2900 n=n+q:IF n>=639 THEN RETURN
2910 MOVE n,cst
2920 a=INT(RND(2)*2)
2930 IF a=0 THEN ocl=ocl-2 ELSE ocl=ocl+2
2940 IF ocl<=-4 THEN GOTO 2900 ELSE PLOT n,cst+ocl
2950 n=n+4:IF n>=639 THEN GRAPHICS PEN 1:RETURN
2960 GOTO 2920
2970 ot=INT(RND(2)*6):ht=vv+ot
2980 MOVE 0,vv
2990 GRAPHICS PEN 1:n=0
3000 IF ch=6 THEN INK 1,26
3010 a=INT(RND(2)*2)
3020 IF a=0 THEN of=2 ELSE of=-3
3030 ht=ht+of:IF ht<vv THEN n=n+INT(RND(2)*50)+25:ht=vv+ot:GOTO 3060
3040 MOVE n,vv:DRAW n,ht
3050 n=n+4
3060 IF n>639 THEN 3080
3070 GOTO 3010
3080 RETURN
3090 x=INT(RND(2)*500)+65:y=INT(RND(2)*350)+40
3100 IF ch>3 THEN GRAPHICS PEN 0
3110 IF ch=7 THEN GRAPHICS PEN 13:INK 13,26
3120 IF ch=5 THEN GRAPHICS PEN 13:INK 13,25
3130 IF ch=3 THEN GRAPHICS PEN 13:INK 13,16
3140 IF ch<3 THEN GRAPHICS PEN 13:INK 13,26
3150 MOVE x,y:DRAWR 8,4:DRAWR 8,0:DRAWR 8,-4:DRAWR 8,0:MOVER 4,0:DRAWR 8,4:DRAWR 8,0:DRAWR 8,-4
3160 MOVE x+28,y+2:DRAWR 4,0:MOVER -4,-4:DRAWR 4,0
3170 RETURN
3180 REM YACHTS
3190 GRAPHICS PEN 4
3200 MOVE x,y:DRAWR 104,0:MOVER -96,-2:DRAWR 88,0:MOVER -84,-2:DRAWR 80,0:MOVER -76,-2:DRAWR 72,0:MOVER -68,-2:DRAWR 64,0:MOVER -60,-2:DRAWR 56,0
3210 MOVE x+48,y+2:GRAPHICS PEN 0:DRAWR 0,84
3220 qq=INT(RND(2)*5)+8:GRAPHICS PEN qq
3230 MOVE x+4,y+4:FOR v=36 TO 0 STEP -4:FOR w=1 TO 4:DRAWR v,0:MOVER -v,1:NEXT w:MOVER 4,1:NEXT v
3240 MOVE x+100,y+4:FOR v=48 TO 0 STEP -4:FOR w=1 TO 4:DRAWR -v,0:MOVER v,1:NEXT w:MOVER -4,1:NEXT v
3250 RETURN
3260 IF ch<3 THEN INK 8,15:INK 9,6:INK 10,25:INK 11,8:INK 12,19
3270 IF ch>2 THEN INK 8,9:INK 9,3:INK 10,10:INK 11,4:INK 12,13
3280 vv=24:FOR tm=1 TO 4
3290 qt=INT(RND(2)*2):IF qt=1 THEN GOTO 3310
3300 x=INT(RND(2)*500)+24:y=st-vv:GOSUB 3180
3310 vv=vv+16:y=st-vv:IF y<16 THEN GOTO 3330
3320 NEXT tm
3330 RETURN
3340 GRAPHICS PEN 1:st=INT(RND(2)*100)+150:dst=st+70:cst=350:bst=st-60
3350 PLOT 0,st:DRAW 639,st:MOVE 0,st+5:FILL 2
3360 a=INT(RND(2)*2):IF a=1 THEN INK 3,25 ELSE INK 3,12
3370 PLOT 0,st-50:DRAW 639,st-50:MOVE 0,st-15:FILL 7:MOVE 0,st-55:FILL 3
3380 GOSUB 260:GOSUB 340
3390 qz=INT(RND(2)*3):IF qz=0 THEN c=26
3400 IF qz=1 THEN c=16
3410 IF qz=2 THEN c=15
3420 INK 14,c:st2=bst:INK 8,3:INK 10,9:GOSUB 1430:GOSUB 1530:GOSUB 1530:GOSUB 1300:GOSUB 1300:GOSUB 1300
3430 v=INT(RND(2)*10)+2:FOR w=0 TO v:GOSUB 3090:NEXT w
3440 BORDER 0:RETURN
3450 FOR w=1 TO 16:PEN w-1:CALL &7800,@nk%,w-1:qnk (w)=nk%:NEXT w
3460 n$=lt$+CHR$(ccc)
3470 tt$="pic"+n$+".col":OPENOUT tt$
3480 FOR n=1 TO 16:PRINT#9,qnk(n):NEXT n:CLOSEOUT
3490 ss$="pic"+n$+".srn":SAVE ss$,b,49152,16384
3500 ccc=ccc+1:BORDER 0:GOTO 60
3510 RANDOMIZE TIME:MODE 0:DEG:INK 0,0:GOSUB 4730:BORDER 0:GRAPHICS PAPER 0
3520 ENV 1,1,15,10,15,-1,10:ENV 2,15,1,1,15,-1,1,15,1,1,15,-1,1,15,1,1:ENT -2,1,1,10,1,-1,10,1,-1,10,1,1,10:ENV 3,1,15,10,15,-1,1:ENV 4,1,15,50,15,-1,25:ENT -4,25,2,2,5,-25,2:ENT -5,5,3,2,5,-3,2,5,-3,2,5,3,2:ENV 5,1,15,100,15,-1,26
3530 ENV 6,15,1,5,1,0,100,5,-1,40,5,1,40,15,-1,25
3540 c=INT(RND(2)*16)
3550 x=320:y=200:GOSUB 4470:GOSUB 4670:GOSUB 4240:GOSUB 4150:GOSUB 4430
3560 IF INKEY$=CHR$(32)THEN RETURN
3570 c=INT(RND(2)*16):x=INT(RND(2)*550)+50:y=INT(RND(2)*320)+50:st=INT(RND(2)*30)+2
3580 hz=INT(RND(2)*200)+25:el=INT(RND(2)*2):v=INT(RND(2)*11)+5
3590 IF el=0 THEN vz=hz ELSE vz=INT(RND(2)*200)+20
3600 GRAPHICS PEN c
3610 wh=INT(RND(2)*48)+1
3620 ON wh GOSUB 4020,4070,4300,3650,3700,3710,3720,3750,3780,3790,3820,3830,3840,4390,3850,3860,3870,3880,3890,3900,3930,3940,3960,4020,4070,4080,4090,4100,3950,4110,4150,4210,4240,4270,4280,4290,4300,4350,4390,4430,4510,4520,4580,4620,4740,4770,4860
3630 IF wh>47 THEN alt=wh-47:ON alt GOSUB 5070
3640 GOTO 3560
3650 SOUND 1,x,160,v,4,4:SOUND 4,y,160,v,4,4
3660 q=INT(RND(2)*4)
3670 FOR a=1 TO 360 STEP st
3680 MOVE x,y,c,q:SOUND 2,st*3+c,2,12
3690 DRAW x+hz*COS(a),y+vz*SIN(a):NEXT:RETURN
3700 MOVE x,y,c,1:DRAWR hz,0:DRAWR 0,-vz:DRAWR -hz,0:DRAWR 0,vz:SOUND 1,x,213,0,2,2:SOUND 2,y,179,0,2,2:SOUND 4,st,159,0,2,2:RETURN
3710 q=INT(RND(2)*4):MOVE x,y,c,q:DRAWR hz,0:DRAWR 0,-vz:DRAWR -hz,0:DRAWR 0,vz:SOUND 1,x,20,0,1,2:SOUND 2,y,20,0,1,2:SOUND 4,st,20,0,1,2:RETURN
3720 q=INT(RND(2)*4):FOR a=1 TO 360 STEP st
3730 MOVE x,y,c,q:SOUND 2,st*3+c,3,15
3740 DRAW x+hz*COS(a),y+vz*SIN(a):NEXT:SOUND 5,st+100,160,12,1:RETURN
3750 SOUND 1,st+200,50,15,,2:SOUND 2,st+205,50,15,,2:SOUND 4,st+210,50,15,,2:FOR a=1 TO 360 STEP 10
3760 q=INT(RND(2)*4):MOVE x,y,c,1
3770 DRAW x+hz*COS(a),y+vz*SIN(a):NEXT:SOUND 3,st+100,50,15,,2:RETURN
3780 ik=INT(RND(2)*4):INK 0,ik:BORDER ik:SOUND 1,200+st,100,0,1,2:SOUND 2,300+st,100,0,1,2:SOUND 4,400+st,100,0,1,2:RETURN
3790 FOR a=1 TO 360 STEP st
3800 MOVE x,y,0,0
3810 DRAW x+hz*COS(a),y+vz*SIN(a):NEXT:RETURN
3820 MOVE x,y,c,0:FOR n=1 TO vz:DRAWR hz,0:MOVER -hz,8:NEXT:SOUND 1,10+vz,60,0,2:SOUND 2,15+vz,60,0,2:SOUND 4,20+vz,60,0,2:RETURN
3830 SOUND 1,10+vz,75,,0,1:SOUND 2,50+vz,75,0,1:SOUND 4,100+vz,75,0,1:MOVE x,y,c,1:FOR n=1 TO vz:DRAWR hz*4,0:MOVER -hz*4,8:NEXT:RETURN
3840 INK 0,0:BORDER 0:RETURN
3850 MOVE x,y,c,0:FOR n=1 TO hz:DRAWR 0,vz*2:MOVER 16,-vz*2:NEXT:SOUND 5,400,80,0,2,2:SOUND 2,405,80,0,1,2:RETURN
3860 FOR n=0 TO 639 STEP 8:MOVE n,0,0,0:DRAW n,399:NEXT:RETURN
3870 FOR n=0 TO 399 STEP 16:MOVE 0,n,0,0:DRAW 639,n:NEXT:RETURN
3880 q=INT(RND(2)*4):FOR n=0 TO 639 STEP 8:MOVE n,0,c,q:DRAW n,399:NEXT:RETURN
3890 q=INT(RND(2)*4):FOR n=0 TO 399 STEP 16:MOVE 0,n,c,q:DRAW 639,n:NEXT:RETURN
3900 FOR a=1 TO 360 STEP 3
3910 MOVE x,y,0,0:SOUND 7,45,3,15
3920 DRAW x+200*COS(a),y+200*SIN(a):NEXT:SOUND 5,st+100,160,12,1:RETURN
3930 MASK 85,1:RETURN
3940 MASK 255,0:RETURN
3950 MASK 153:RETURN
3960 ORIGIN 320,200:DEG:MASK 255,0
3970 FOR sz=20 TO 200 STEP 20:c=INT(RND(2)*16)
3980 SOUND 5,sz,100,0,1:SOUND 2,sz+5,100,0,1:q=INT(RND(2)*4)
3990 MOVER 0,sz,c,q:FOR a=0 TO 360 STEP 10
4000 DRAW sz*SIN(a),sz*COS(a)
4010 NEXT a:NEXT sz:ORIGIN 0,0:RETURN
4020 SOUND 7+128,0:FOR n=1 TO 10
4030 FOR p=1 TO 15:c=INT(RND(2)*26):INK p,c:NEXT p
4040 SOUND 1,n*100,90,0,1:SOUND 2,n*200,90,0,1:SOUND 4,n*250,90,0,1
4050 FOR w=1 TO 650:NEXT w
4060 NEXT n
4070 GOSUB 4730:SOUND 1,478,60,0,1:SOUND 2,379,60,0,1:SOUND 4,319,60,0,1:RETURN
4080 FOR n=0 TO hz STEP 8:MOVE x-n,y+n,c,0:DRAWR n+8+n,0:DRAWR 0,-(n+8+n):DRAWR -(n+8+n),0:DRAWR 0,n+8+n:NEXT n:RETURN 
4090 FOR n=0 TO hz STEP 8:MOVE x-n,y+n,c,1:DRAWR n+8+n,0:DRAWR 0,-(n+8+n):DRAWR -(n+8+n),0:DRAWR 0,n+8+n:NEXT n:RETURN 
4100 FOR n=0 TO vz*2 STEP 8:MOVE x-n,y+n,0,0:DRAWR n+8+n,0:DRAWR 0,-(n+8+n):DRAWR -(n+8+n),0:DRAWR 0,n+8+n:NEXT n:RETURN 
4110 FOR n=0 TO 15:INK n,0:NEXT:IF c<4 THEN c=18
4120 INK 1,c:FOR n=2 TO 15:INK n,c:INK n-1,0:SOUND 1,20*n,50,0,1,2:SOUND 2,30*n,50,0,1,2:SOUND 4,40*n,50,0,1,2
4130 FOR w=1 TO 300:NEXT w:NEXT n
4140 GOSUB 4730:RETURN
4150 FOR n=1 TO 15:MOVE x-(12*n),y+(12*n),n,0:DRAWR (12*n)+20+(12*n),0:DRAWR 0,-((12*n)+20+(12*n)):DRAWR -((12*n)+20+(12*n)),0:DRAWR 0,(12*n)+20+(12*n):NEXT n 
4160 SOUND 4,350,425,0,4,,1:SOUND 1,250,425,0,4,,4:SOUND 2,450,425,0,4
4170 FOR n=1 TO 15:INK n,0:NEXT:IF c<4 THEN c=20
4180 FOR t=1 TO 15
4190 INK 1,c:FOR n=2 TO 15:INK n,c:INK n-1,0:INK 15,0:FOR w=1 TO 20:NEXT w:NEXT n
4200 NEXT t:GOSUB 4730:RETURN
4210 FOR n=1 TO 15:MOVE x-(12*n),y+(12*n),n,0:DRAWR (12*n)+20+(12*n),0:DRAWR 0,-((12*n)+20+(12*n)):DRAWR -((12*n)+20+(12*n)),0:DRAWR 0,(12*n)+20+(12*n):NEXT n 
4220 RETURN
4230 q=INT(RND(2)*4):MOVE x,y,c,q:DRAWR hz,0:DRAWR -(hz/2),hz:DRAWR -(hz/2),-hz:RETURN
4240 FOR w=0 TO 15
4250 q=INT(RND(2)*4):s=w*12:MOVE x-s,y-s,w,q:DRAWR s+hz+s,0:DRAWR -(s+hz+s)/2,s+hz+s:DRAWR -(s+hz+s)/2,-(s+hz+s)
4260 NEXT w:RETURN
4270 SOUND 1,213,100,0,1:SOUND 2,179,100,0,1:SOUND 4,80,100,0,1:FOR n=1 TO 15 STEP 5:c=INT(RND(2)*14)+1:f=INT(RND(2)*14)+1:INK n,c,f:NEXT n:RETURN
4280 SOUND 1,319,150,0,2:SOUND 2,159,150,0,2,2:SOUND 4,179,150,0,2,2:INK 1,25:INK 2,22:INK 3,16:INK 4,17:INK 5,10:INK 6,13:INK 7,20:INK 8,0:INK 9,6:INK 10,4:INK 11,7:INK 12,8:INK 13,1:INK 14,24:INK 15,14:RETURN
4290 SPEED INK 6,8:SOUND 1,50,150,0,1,4:SOUND 2,75,150,0,1,4:SOUND 4,100,150,0,1,4:RETURN
4300 SOUND 7+128,0:FOR n=2 TO 50 STEP 2
4310 FOR p=1 TO 15:c=INT(RND(2)*26):INK p,c:NEXT p
4320 SOUND 1,n*8,12,15,,2:SOUND 2,n*10,12,15,,2:SOUND 4,n*12,12,15,,4
4330 FOR w=1 TO 70:NEXT w
4340 NEXT n:FOR w=1 TO 100:NEXT w:SOUND 7+128,0:SOUND 1,758,60,0,1:SOUND 2,301,60,0,1:SOUND 4,127,60,0,1:RETURN
4350 fa=INT(RND(2)*27):fb=INT(RND(2)*26)+1:INK 1,fa,fb:SPEED INK 3,3:FOR n=1 TO 250:x=INT(RND(2)*640):y=INT(RND(2)*400):v=INT(n/40):PLOT x,y,1,1:DRAWR 8,0:DRAWR 0,-8:DRAWR -8,0:DRAWR 0,8:SOUND 1,20+n,5,v,2:SOUND 2,30+n,5,v,2:SOUND 4,40+n,5,v,2:NEXT
4360 INK 0,26,0:BORDER 0,26:FOR n=1 TO 250:NEXT n:INK 0,0:BORDER 0:INK 1,c
4370 GOSUB 4990:SOUND 7+128,0
4380 RETURN
4390 SOUND 7+128,0:FOR w=1 TO 2
4400 RESTORE 4410:FOR n=1 TO 8:READ a,b,c:SOUND 1,a,50,0,2,2:SOUND 4,b,50,0,2,2:SOUND 2,c,50,15,2,2:INK 1,n:NEXT n:NEXT w
4410 DATA 956,379,80,851,358,71,716,284,60,638,358,53,568,379,47,638,358,53,568,379,60,956,379,71
4420 RETURN
4430 SOUND 7+128,0:FOR w=1 TO 2:FOR ik=0 TO 15:INK ik,0:NEXT ik
4440 RESTORE 4450:FOR n=1 TO 16:READ a,b,c:fa=INT(RND(2)*25)+1:INK n-1,fa:INK 0,0:SOUND 1,a,40,0,2,2:SOUND 4,b,40,0,2,2:SOUND 2,c,40,0,2,2:FOR dl=1 TO 300:NEXT dl:kk=kk+1:NEXT n:NEXT w
4450 DATA 956,402,159,851,358,159,804,319,119,638,239,159,804,319,150,956,358,159,851,402,179,1276,478,159,956,402,201,851,358,159,804,319,213,638,239,159,804,319,239,851,301,201,956,358,213,478,319,159
4460 RETURN
4470 SOUND 1,638,180,0,4:SOUND 2,319,180,0,4:SOUND 4,159,180,0,4:SOUND 1,568,90,0,4:SOUND 2,284,90,0,4:SOUND 4,142,90,0,4:SOUND 1,478,90,0,4:SOUND 2,239,90,0,4:SOUND 4,119,90,0,4:
4480 SOUND 1,956,350,0,2:SOUND 2,319,350,0,4:SOUND 4,95,350,0,4:RETURN
4490 FOR n=1000 TO 100 STEP -10:SOUND 2,956,5,0,3:SOUND 1,n,5,0,3:SOUND 4,1100-n,5,0,3:NEXT
4500 SOUND 1,956,200,0,2:SOUND 2,319,200,0,4:SOUND 4,95,200,0,4:RETURN
4510 SOUND 7+128,0:GOSUB 4860:GOSUB 4470:RETURN
4520 FOR n=1 TO 15:MOVE x-(12*n),y+(12*n),n,0:DRAWR (12*n)+20+(12*n),0:DRAWR 0,-((12*n)+20+(12*n)):DRAWR -((12*n)+20+(12*n)),0:DRAWR 0,(12*n)+20+(12*n):NEXT n 
4530 SOUND 4,150,425,0,4,,1:SOUND 1,100,425,0,4,,21:SOUND 2,450,425,0,4,1
4540 FOR n=1 TO 15:INK n,0:NEXT:IF c<4 THEN c=20
4550 FOR t=1 TO 15
4560 INK 15,c:FOR n=14 TO 1 STEP -1:INK n,c:INK n+1,0:INK 1,0:FOR w=1 TO 20:NEXT w:NEXT n
4570 NEXT t:GOSUB 4730:RETURN
4580 FOR n=0 TO 15:INK n,0:NEXT:IF c<4 THEN c=18
4590 INK 15,c:FOR n=14 TO 1 STEP-1:INK n,c:INK n+1,0:SOUND 1,20*n,50,0,1,2:SOUND 2,30*n,50,0,1,2:SOUND 4,40*n,50,0,1,2
4600 FOR w=1 TO 300:NEXT w:NEXT n
4610 GOSUB 4730:RETURN
4620 SOUND 7+128,0:FOR w=1 TO 2
4630 RESTORE 4640:FOR n=1 TO 16:READ a,b,c:INK 16-n,0:SOUND 1,a/2,40,0,2,2:SOUND 4,b/2,40,0,2,2:SOUND 2,c/2,40,0,2,2:FOR dl=1 TO 300:NEXT dl:kk=kk+1:NEXT n:GOSUB 4730:NEXT w
4640 DATA 956,402,159,851,358,159,804,319,119,638,239,159,804,319,150,956,358,159,851,402,179,1276,478,159,956,402,201,851,358,159,804,319,213,638,239,159,804,319,239,851,301,201,956,358,213,478,319,159
4650 RETURN
4660 GOSUB 4470:RETURN
4670 INK 0,0:FOR n=1 TO 15:INK n,n:NEXT
4680 MODE 0:MOVE 316,204:c=1
4690 FOR w=8 TO 639 STEP 8:GRAPHICS PEN c
4700 DRAWR w,0:DRAWR 0,-(INT(w/1)):DRAWR-w,0:DRAWR 0,INT(w/1):MOVER -4,4
4710 c=c+1:IF c>15 THEN c=1
4720 NEXT
4730 clr=INT(RND(2)*4)+1:ON clr GOSUB 4900,4910,4920,4930,4940,4950,4960,4970,4980:RETURN
4740 SOUND 7+128,0:SOUND 1,956,500,0,5,5:SOUND 2,190,500,0,5,5:SOUND 4,319,500,0,5,5,1
4750 FOR t=1 TO 20:FOR w=1 TO 16:PEN w-1:CALL &7800,@nk%,w-1:qnk (w)=nk%:NEXT w
4760 FOR n=16 TO 2 STEP -1: spr=qnk(n):INK (17-n),spr:NEXT n:NEXT t:RETURN 
4770 DEFREAL s:SOUND 7+128,0:SOUND 1,284,750,0,6,2:SOUND 2,213,750,0,6,2,21:SOUND 4,179,750,0,6,2
4780 FOR qtart=12288 TO 12888:GOSUB 4810:NEXT
4790 SOUND 1,851,750,0,6,5:SOUND 2,358,750,0,6,5,21:SOUND 4,142,750,0,6,2
4800 FOR qtart=12888 TO 12288 STEP -1:GOSUB 4810:NEXT:RETURN
4810 OUT &BC00,12
4820 OUT &BD00,INT(qtart/256)
4830 OUT &BC00,13
4840 OUT &BD00,qtart-256*INT(qtart/256)
4850 RETURN
4860 BORDER 3:FOR n=0 TO 15:INK n,3:NEXT:c=INT(RND(2)*12)+4
4870 INK 15,c:FOR n=14 TO 2 STEP-1:INK n,c:INK n+1,0:SOUND 1,20*n,50,0,1,2:SOUND 2,30*n,50,0,1,2:SOUND 4,40*n,50,0,1,2
4880 FOR w=1 TO 300:NEXT w:NEXT n
4890 GOSUB 4730:RETURN
4900 INK 1,26:INK 2,1:INK 3,6:INK 4,5:INK 5,8:INK 6,9:INK 7,14:INK 8,11:INK 9,15:INK 10,18:INK 11,24:INK 12,25:INK 13,23:INK 14,20:INK 15,21:RETURN
4910 INK 1,24:INK 2,18:INK 3,7:INK 4,6:INK 5,7:INK 6,8:INK 7,9:INK 8,14:INK 9,11:INK 10,16:INK 11,25:INK 12,21:INK 13,20:INK 14,1:INK 15,5:RETURN
4920 INK 1,21:INK 2,2:INK 3,5:INK 4,6:INK 5,5:INK 6,8:INK 7,17:INK 8,19:INK 9,9:INK 10,15:INK 11,25:INK 12,18:INK 13,0:INK 14,21:INK 15,20:RETURN
4930 INK 1,26:INK 2,1:INK 3,3:INK 4,3:INK 5,10:INK 6,13:INK 7,12:INK 8,14:INK 9,0:INK 10,5:INK 11,25:INK 12,26:INK 13,20:INK 14,10:INK 15,13:RETURN
4940 INK 0,0:BORDER 0:RETURN
4950 INK 0,1:BORDER 1:RETURN
4960 INK 0,2:BORDER 2:RETURN
4970 INK 0,3:BORDER 3:RETURN
4980 INK 0,0:BORDER 0:RETURN
4990 ENV 7,1,15,1,1,0,50,1,-15,1,1,15,1,15,-1,35
5000 SOUND 1,500,575,0,1,,10:FOR w=1 TO 100:NEXT:SOUND 4,800,575,0,1,,20:FOR w=1 TO 200:NEXT:SOUND 2,2200,575,0,1,,31
5010 FOR n=1 TO 10
5020 OUT &BC00,7:OUT &BD00,31
5030 FOR w=1 TO 50:NEXT
5040 OUT &BC00,7:OUT &BD00,30
5050 FOR w=1 TO 50:NEXT
5060 NEXT:OUT &BC00,7:OUT &BD00,30:RETURN
5070 SOUND 7+128,0:RESTORE 5160:chr=40
5080 FOR n=0 TO 7
5090 READ a,b,c:SOUND 1,a,50,0,2,2:SOUND 4,b,50,0,2,2:SOUND 2,c,50,15
5100 OUT &BC00,1:OUT &BD00,n+chr:FOR w=1 TO 400:NEXT w:NEXT n
5110 RESTORE 5160
5120 FOR n=7 TO 0 STEP -1
5130 READ a,b,c:SOUND 1,a,50,0,2,2:SOUND 4,b,50,0,2,2:SOUND 2,c,50,15
5140 OUT &BC00,1:OUT &BD00,n+chr:FOR w=1 TO 400:NEXT w:NEXT n
5150 RETURN
5160 DATA 956,239,190,1276,253,159,1136,284,213,1012,319,159,478,239,142,638,253,159,568,284,190,506,319,213
5170 pai=0:IF ch=5 THEN pai=1:GOTO 590: ELSE pai=0:GOTO 590
5180 GOSUB 5430
5190 MODE 1:LOCATE 5,10:PRINT"ENTER NAME OF PICTURE TO EDIT ":LOCATE 5,12:INPUT t$:tt$=t$+".srn":vv$=t$+".col"
5200 MODE 0:BORDER 13:PAPER 0:CLS:OPENIN vv$
5210 FOR n=1 TO 16:INPUT#9,nk:INK n-1,nk:qnk(n)=nk:NEXT n:CLOSEIN
5220 LOAD tt$,49152
5230 c=5
5240 BORDER qnk(c):x=320:y=200
5250 MOVE x,y,c,1:PLOT x,y:TAG
5260 a$=INKEY$:IF a$="" THEN 5260
5270 IF a$=CHR$(16) THEN GOTO 5180
5280 IF a$=CHR$(224) THEN GOSUB 5460:GOTO 1130
5290 IF a$=CHR$(13) THEN c=c+1:GOSUB 5410:GOTO 5260
5300 IF a$=CHR$(242)THEN PLOT x,y:x=x-4:GOSUB 5360:PLOT x,y:GOTO 5260
5310 IF a$=CHR$(243)THEN PLOT x,y:x=x+4:GOSUB 5360:PLOT x,y:GOTO 5260
5320 IF a$=CHR$(240)THEN PLOT x,y:y=y+2:GOSUB 5360:PLOT x,y:GOTO 5260
5330 IF a$=CHR$(241)THEN PLOT x,y:y=y-2:GOSUB 5360:PLOT x,y:GOTO 5260
5340 PLOT x,y:MOVE x,y,c-1,0:PRINT a$;:x=x+32:GOSUB 5360:MOVE x,y,1,1:PLOT x,y:GOTO 5260
5350 GOTO 5260
5360 IF x>639 THEN x=639
5370 IF x<0 THEN x=0
5380 IF y<0 THEN y=0
5390 IF y>399 THEN y=399
5400 RETURN
5410 IF c>15 THEN c=2
5420 BORDER qnk(c):RETURN
5430 MODE 1:LOCATE 2,10:PRINT"ENTER NAME FOR PICTURE AFTER TEXT ADDED"
5440 LOCATE 10,13:INPUT ft$:IF LEN(ft$)>6 THEN GOTO 5430
5450 RETURN
5460 FOR w=1 TO 16:PEN w-1:CALL &7800,@nk%,w-1:qnk (w)=nk%:NEXT w
5470 hd$=".col":t$=ft$+hd$:OPENOUT t$
5480 FOR n=1 TO 16:PRINT#9,qnk(n):NEXT n:CLOSEOUT
5490 hd$=".srn":t$=ft$+hd$:SAVE t$,b,49152,16384
5500 RETURN
*/ });
