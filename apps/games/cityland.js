/* globals cpcBasic */

"use strict";

cpcBasic.addItem("", function () { /*
1 rem cityland - Citylander
2 rem (c) Jujstronic Software, 1985
3 rem https://www.cpc-power.com/index.php?page=detail&onglet=dumps&num=16465
4 rem Modifications: some delay; display hint on how to bomb
5 rem
10 ' **********************************
20 ' *                                *
30 ' *           CITYLANDER           *
40 ' *                                *
50 ' *      Copyright (c) 1985 by     *
60 ' *                                *
70 ' *       JUJSTRONIC Software      *
80 ' *                                *
90 ' **********************************
100 '
110 ' FUNKTIONSDEFINIERUNG
120 '
130 DEFINT a-z:DEF FNh(x)=ROUND(1250/(4.4*2^(1+(x-10)/12)))
140 '
150 ' TASTENDEFINIERUNG
160 '
170 KEY DEF 6,0,88
180 '
190 ' ZEICHENDEFINIERUNG
200 '
210 SYMBOL 251,102,0,102,102,102,102,60:SYMBOL 253,0,60,126,165,165,126,60
220 SYMBOL 254,254:SYMBOL 255,254,146,146,146,254,146,146,146
230 '
240 ' ANFANGSGRAFIK
250 '
260 INK 0,0:INK 1,26:INK 2,0:INK 3,0:PEN 1:PAPER 3:BORDER 0:CLS
270 DEFINT a-c,l,s,x-y
280 RESTORE:sp=25
290 FOR a=1 TO 5:READ h:SOUND 1,h,sp:NEXT
300 DATA 95,100,95,100,95
310 LOCATE 7,25:PRINT"JUJSTRONIC SOFTWARE PRESENTS"
320 FOR a=1 TO 25:PRINT:FOR b=1 TO 50:NEXT b,a
330 FOR a=1 TO 3:READ h:SOUND 1,h,sp:NEXT
340 DATA 127,106,119
350 a=0:c=0:d=8
360 INK 1,0
370 WHILE a<400
380 PLOT 320-a*0.8,200+a*0.5,c MOD 3:DRAWR 1.6*a,0:DRAWR 0,-a
390 DRAWR-1.6*a,0:DRAWR 0,a:a=a+d:c=c+1:d=d*1.5
400 WEND
410 LOCATE 12,3:PRINT"C I T Y L A N D E R"
420 LOCATE 9,23:PRINT"BITTE EINE TASTE DR"+CHR$(251)+"CKEN"
430 '
440 ' ANFANGSMUSIK
450 '
460 EVERY 10 GOSUB 920
470 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,142,sp:NEXT
480 DATA 284,379,284,239
490 FOR a=1 TO 4:READ h:SOUND 12,190,sp:SOUND 33,h,sp:NEXT
500 DATA 142,190,142,119
510 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,127,sp:NEXT
520 DATA 301,379,301,253
530 FOR a=1 TO 4:READ h:SOUND 12,190,sp:SOUND 33,h,sp:NEXT
540 DATA 127,190,150,127
550 FOR a=1 TO 8:READ h:SOUND 12,h,sp:SOUND 33,119,sp:NEXT
560 DATA 284,379,284,239,190,239,284,402
570 FOR a=1 TO 8:READ h:SOUND 12,379,sp:SOUND 33,h,sp:NEXT
580 DATA 95,100,95,100,95,127,106,119
590 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,142,sp:NEXT
600 DATA 284,379,284,239
610 FOR a=1 TO 4:READ h:SOUND 12,190,sp:SOUND 33,h,sp:NEXT
620 DATA 142,190,142,119
630 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,127,sp:NEXT
640 DATA 301,379,301,253
650 FOR a=1 TO 4:READ h:SOUND 12,190,sp:SOUND 33,h,sp:NEXT
660 DATA 127,190,119,127
670 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,142,sp:NEXT
680 DATA 142,190,239,253
690 FOR a=1 TO 4:READ h:SOUND 12,284,sp:SOUND 33,h,sp:NEXT
700 DATA 142,127,119,106
710 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,95,sp:NEXT
720 DATA 119,159,190,213
730 FOR a=1 TO 4:READ h:SOUND 12,239,sp:SOUND 33,h,sp:NEXT
740 DATA 95,95,89,95
750 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,106,sp:NEXT
760 DATA 127,159,213,253
770 FOR a=1 TO 4:READ h:SOUND 12,319,sp:SOUND 33,h,sp:NEXT
780 DATA 106,106,95,106
790 FOR a=1 TO 4:READ h:SOUND 12,h,sp:SOUND 33,119,sp:NEXT
800 DATA 142,190,239,253
810 FOR a=1 TO 4:READ h:SOUND 12,284,sp:SOUND 33,h,sp:NEXT
820 DATA 119,119,106,119
830 FOR a=1 TO 12:READ h:SOUND 12,h,sp:SOUND 33,127,sp:NEXT
840 DATA 379,301,253,301,253,190
850 DATA 253,190,150,190,150,253
860 FOR a=1 TO 8:READ h:SOUND 12,190,sp:SOUND 33,h,sp:NEXT
870 DATA 95,100,95,100,95,127,106,119
880 RESTORE 470:c=c MOD 3:GOTO 470
890 '
900 ' TASTATURABFRAGE
910 '
920 INK c MOD 3,2:INK(c+1)MOD 3,0:INK(c+2)MOD 3,0:c=c+1
930 IF INKEY$=""THEN RETURN
940 '
950 ' HAUPTPROGRAMM
960 '
970 ENT 1,50,-4,1:ENT 2,3,4,1:ENT 3,100,4,1:ENT 4,140,2,1
980 l$=CHR$(15)+CHR$(3)+CHR$(224)+CHR$(224)+CHR$(224)+CHR$(224)
990 INK 2,0:PAPER 2:CLS:PLOT 640,640,1:INK 0,1:INK 1,26:INK 3,2
1000 PAPER 0:PRINT" SCORE 0000    CITYLANDER    LIVES "+l$+" "
1010 PAPER 2:FOR a=1 TO 80:PLOT RND*640,RND*240+144:NEXT
1020 RANDOMIZE TIME
1030 FOR a=1 TO 40:SOUND 130,180,20,,,1:call &bd19:LOCATE a,25:PRINT CHR$(254);
1040 FOR b=24 TO RND*14+10 STEP-1:LOCATE a,b:PRINT CHR$(255):NEXT b,a
1050 TAG:FOR a=0 TO 12 STEP 2
1060 SOUND 129,FNh(a+1),100:SOUND 130,FNh(a+5),100:SOUND 132,FNh(a+8),100
1065 t!=time+100
1070 MOVE 0,a:PRINT" COPYRIGHT (c) 1985 JUJSTRONIC SOFTWARE ";
1075 while time<t!:call &bd19:wend
1080 NEXT a:TAGOFF
1090 PEN 1:b=0:l=5:s=0
1100 b$=CHR$(252):k$=CHR$(88)
1105 '
1106 after 200,1 gosub 1800
1110 x=1:y=3:FOR a=1 TO 4:SOUND 12,2499,12,,,2:SOUND 33,2500,12,,,2:NEXT
1120 s$=STR$(s):PAPER 0:LOCATE 13-LEN(s$),1:PRINT MID$(s$,2)
1130 PAPER 2:LOCATE x,y:PRINT" ":LOCATE x+1,y:PRINT CHR$(253)
1140 SOUND 12,2499,12,,,2:SOUND 33,2500,12,,,2:x=x+1:IF x=41 THEN x=1:y=y+1
1150 IF y=24 THEN IF x=20 THEN 1440
1160 IF TEST(x*16*-(x<40),415-y*16+(x=40)*16)=3 THEN 1240
1170 IF RND>0.85 THEN PLOT INT(16*(x-1-RND)),INT(16*(26-y-RND)),1
1180 IF b THEN LOCATE bx,by+11-b:PRINT" ":b=b-1:IF by-b=14 THEN b=0
1190 i$=INKEY$:IF b=0 THEN 1220
1200 IF RND>0.85 THEN PLOT INT(16*(bx-RND)),255-INT(16*(by-b+RND))
1210 s=s+TEST(16*bx-3,239-16*(by-b))*10-20:LOCATE bx,by+11-b:PRINT b$:GOTO 1120
1220 IF i$=k$THEN SOUND 130,80,140,,,4:b=11:bx=x+1:by=y:LOCATE bx,by:PRINT b$
1230 WHILE bx=41:bx=1:by=by+1:WEND:GOTO 1120
1240 LOCATE x,y:PRINT" ":LOCATE x+1,y:PRINT CHR$(238)
1250 SOUND 129,99,100,,,3:SOUND 130,100,100,,,3:SOUND 132,101,100,,,3
1260 FOR a=1 TO 160:INK 2,RND*26:NEXT:INK 2,0:FOR a=1 TO 2000:NEXT
1270 l=l-1:PAPER 0:LOCATE 36,1:PRINT LEFT$(l$,l+1);" "
1280 PAPER 2:IF l=0 THEN 1340
1290 LOCATE x+1,y:PRINT CHR$(255):PEN 1
1300 FOR a=1 TO 20:i$=INKEY$:NEXT:GOTO 1110
1310 '
1320 ' ALLE LEBEN VERLOREN
1330 '
1340 FOR a=1 TO 2000:NEXT
1350 PEN 1:LOCATE 11,13:PRINT" G A M E    O V E R "
1360 sp=30:RESTORE 1390
1370 FOR a=1 TO 11:READ h,l:SOUND 33,284,l*sp:SOUND 2,h,l*sp:SOUND 12,190,l*sp
1380 SOUND 1,0,1,0:SOUND 34,0,1,0:SOUND 20,0,1,0:NEXT
1390 DATA 142,3,142,2,142,1,142,3,119,2,127,1,127,2,142,1,142,2,150,1,142,5
1400 FOR a=1 TO 10000:NEXT:RUN
1410 '
1420 ' ERFOLGREICHE LANDUNG
1430 '
1440 SOUND 129,0,1,0:SOUND 130,0,1,0:SOUND 132,0,1,0
1450 FOR a=1 TO 16
1460 SOUND 129,99,20,,,1:SOUND 130,100,20,,,1:SOUND 132,101,20,,,1
1470 FOR b=1 TO 30:INK 2,RND*26
1480 NEXT b,a:INK 2,0
1490 FOR a=1 TO 2000:NEXT:CLS:l=l-1:PRINT
1500 PRINT:PRINT"        HERZLICHEN GL"+CHR$(251)+"CKWUNSCH !":PRINT:PRINT
1510 PRINT:PRINT"   SIE HABEN ES GESCHAFFT, SICHER ZU"
1520 PRINT:PRINT"   LANDEN. DABEI HABEN SIE";S;"PUNKTE"
1530 PRINT:PRINT"   ERZIEHLT. F"+CHR$(251)+"R DIE VERBLIEBENEN LEBEN"
1540 PRINT:PRINT"   ERHALTEN SIE AUSSERDEM"+STR$(L*100)+" PUNKTE"
1550 PRINT:PRINT"   BONUS. SOMIT HABEN SIE INSGESAMT"
1560 PRINT:PRINT"  "+STR$(S+100*L)+" PUNKTE ERREICHT.":PRINT:PRINT
1570 PRINT:PRINT"   HABEN SIE GENUG MUT, ES NOCHMALS"
1580 PRINT:PRINT"   ZU VERSUCHEN ? (BITTE J/N DR"+CHR$(251)+"CKEN)"
1590 i$=INKEY$:IF I$="j"OR I$="J"THEN RUN
1600 IF I$="n"OR I$="N"THEN CALL 0
1610 BORDER RND*26:INK 1,RND*26:GOTO 1590
1790 '
1800 locate 1,25:?"Press small ENTER to bomb...";chr$(18):return
*/ });
