/* globals cpcBasic */

"use strict";

cpcBasic.addItem("", function () { /*
1 rem dungeons - Dungeons (8 Bit Dungeons)
2 rem (c) JNL, 2019
3 rem
10  REM 8 BIT DUNGEONS
20  REM BY JNL
30  REM SEPT 2019
40  REM
50  REM INICIALIZA VARIABLES NUMERICAS
60  MODE 1:BORDER 1
70  WINDOW #2,1,26,1,25
80  planta=1:dinero=0
90  REM
100  REM DEFINE GRAFICOS
110  SYMBOL AFTER 48
120  SYMBOL 48,28,38,102,102,102,100,56,0
130  SYMBOL 49,16,56,24,24,24,24,16,0
140  SYMBOL 50,56,92,8,16,32,68,124,0
150  SYMBOL 51,124,72,16,60,12,8,16,32
160  SYMBOL 52,12,28,44,76,126,12,12,8
170  SYMBOL 53,30,36,112,56,28,12,68,56
180  SYMBOL 54,56,96,104,124,108,108,56,0
190  SYMBOL 55,124,100,8,8,16,16,48,24
200  SYMBOL 56,60,102,100,24,38,102,60,0
201  SYMBOL 65,2,54,78,86,38,86,142,0
210  SYMBOL 57,60,102,102,110,118,38,4,24
220  SYMBOL 76,12,54,112,176,48,34,126,0
221 SYMBOL 82,54,91,49,50,60,54,243,0
222 SYMBOL 83,58,68,200,124,38,98,188,0
223 SYMBOL 77,74,254,106,106,106,107,74,0
224 SYMBOL 79,60,70,214,238,198,196,120,0
225 SYMBOL 86,68,238,118,102,102,54,28,0
230  SYMBOL 85,68,238,102,102,102,111,50,0
231 SYMBOL 69,222,100,104,124,100,64,254,0
232 SYMBOL 84,122,174,104,104,104,106,60,0
233 SYMBOL 67,58,86,208,208,208,82,60,0
240  SYMBOL 72,64,228,110,118,102,103,102,4
250  SYMBOL 80,44,246,102,102,118,236,96,240
251 SYMBOL 235,1,7,14,28,58,60,62,28
252 SYMBOL 236,224,216,220,108,240,120,184,112
253 SYMBOL 231,0,0,0,0,0,0,195,239
254 SYMBOL 232,0,0,0,0,48,240,224,192
255 SYMBOL 233,223,239,223,239,223,227,192,0
256 SYMBOL 234,255,255,232,232,208,160,0,0
260  SYMBOL 237,0,254,252,248,240,248,252,254
270  SYMBOL 238,0,127,63,31,15,31,63,127
280  SYMBOL 239,0,255,255,255,255,255,255,255
290  SYMBOL 240,1,35,119,119,113,116,115,114
300  SYMBOL 241,0,128,192,192,192,128,63,187
310  SYMBOL 242,249,6,119,15,15,15,60,30
320  SYMBOL 243,49,187,59,187,191,222,236,112
330  SYMBOL 244,85,254,255,254,255,254,255,254
340  SYMBOL 245,85,255,255,255,255,255,255,255
350  SYMBOL 246,253,170,127,255,255,255,255,127
360  SYMBOL 247,127,170,255,255,255,255,255,254
370  SYMBOL 248,83,238,217,181,181,109,125,109
380  SYMBOL 249,193,113,153,172,172,182,190,182
390  SYMBOL 250,121,102,118,105,125,109,125,109
400  SYMBOL 251,190,182,190,182,190,182,190,182
410  SYMBOL 252,31,55,59,0,59,59,59,59
420  SYMBOL 253,248,252,204,0,204,252,252,252
430  SYMBOL 254,0,0,6,73,249,6,0,0
440  REM
450  REM DEFINE VARIABLES DE LOS SPRITES
460  ret$=STRING$(2,8)+CHR$(10)
470  borr$="  "+ret$+"  "
480  guerr$=CHR$(15)+CHR$(1)+CHR$(240)+CHR$(241)+STRING$(2,8)+CHR$(10)+CHR$(242)+CHR$(243)
490  muro$=CHR$(15)+CHR$(1)+CHR$(244)+CHR$(245)+STRING$(2,8)+CHR$(10)+CHR$(246)+CHR$(247)
500  puerta$=CHR$(15)+CHR$(2)+CHR$(248)+CHR$(249)+ret$+CHR$(250)+CHR$(251)
510  cofre$=CHR$(15)+CHR$(1)+"  "+ret$+CHR$(252)+CHR$(253)
520  llave$=CHR$(15)+CHR$(2)+"  "+ret$+" "+CHR$(254)
530  cintai$=CHR$(15)+CHR$(3)+CHR$(238)+CHR$(239)
540  cintad$=CHR$(15)+CHR$(3)+CHR$(239)+CHR$(237)
541  botin$=CHR$(15)+CHR$(1)+"  "+ret$+CHR$(235)+CHR$(236)
542 mano$=CHR$(15)+CHR$(2)+CHR$(231)+CHR$(232)+ret$+CHR$(233)+CHR$(234)
550  REM
560  REM DIBUJA PANTALLA DE JUEGO
570  GOSUB 1070
580  FOR y=1 TO 12
590  FOR x=1 TO 13
600  IF casilla$(x,y)="*" THEN PAPER 0:LOCATE (x*2)-1,(y*2)-1:PRINT muro$
610  IF casilla$(x,y)="F" THEN PAPER 0:LOCATE (x*2)-1,(y*2)-1:PRINT puerta$
620  NEXT x
630  NEXT y
640  LOCATE 30,1:PAPER 3:PEN 0:PRINT "        "
650  LOCATE 29,2:PAPER 0:PEN 3:PRINT cintai$+"      "+cintad$
660  LOCATE 31,1:PAPER 3:PEN 0:PRINT planta
670  LOCATE 28,4:PAPER 0:PRINT guerr$
680  LOCATE 31,4:PRINT"LV 06"
690  LOCATE 31,5:PRINT"HP 128/580"
691   LOCATE 28,23:PRINT botin$;"x";dinero
700  REM
710  REM DECIDE POSICION ALEATORIA DE JUGADOR Y LLAVE. LOS DIBUJA
720  x=INT(RND*11)+2:y=INT(RND*10)+2 
730  casilla$(x,y)="J"
740  LOCATE (x*2)-1, (y*2)-1:PEN 1:PRINT guerr$
750 llavex=INT(RND*11)+2:llavey=INT(RND*10)+2 
760 IF casilla$(llavex,llavey)<>"." THEN 750
770 casilla$(llavex,llavey)="K"
771 LOCATE (llavex*2)-1, (llavey*2)-1:PRINT llave$
772  REM
773  REM DECIDE POSICION ALEATORIA DE COFRE Y LO DIBUJA
774  cofrex=INT(RND*11)+2:cofrey=INT(RND*10)+2 
775 IF casilla$(cofrex,cofrey)<>"." THEN 774
776 casilla$(cofrex,cofrey)="C"
777 LOCATE (cofrex*2)-1, (cofrey*2)-1:PRINT cofre$
808  REM
809 REM CALCULA OBSTACULOS AL AZAR Y LOS DIBUJA
810 FOR casillay=3 TO 10
820 FOR casillax=3 TO 11
830 IF casilla$(casillax,casillay)<>"." THEN GOTO 860
840  RANDOMIZE RND:obs=INT(RND*4):IF obs<>1 THEN GOTO 860
850  LOCATE (casillax*2)-1,(casillay*2)-1:PRINT muro$:casilla$(casillax,casillay)="*"
860  NEXT casillax
870  NEXT casillay
880 REM
890  REM TURNO DEL JUGADOR
891  GOSUB 2000
900  casilla$(x,y)="J":CLEAR INPUT
901  a$=INKEY$:IF a$="" THEN 901
910  IF a$=CHR$(240) THEN destinox=x:destinoy=y-1:GOTO 970
920  IF a$=CHR$(241) THEN destinox=x:destinoy=y+1:GOTO 970
930  IF a$=CHR$(242) THEN destinox=x-1:destinoy=y:GOTO 970
940  IF a$=CHR$(243) THEN destinox=x+1:destinoy=y:GOTO 970
950 GOTO 901
960  REM
970  REM MOVER JUGADOR
980  IF casilla$(destinox,destinoy)="*" THEN 901
990  IF casilla$(destinox,destinoy)="F" AND llave=1 THEN 1370
1000  IF casilla$(destinox,destinoy)="F" AND llave=0 THEN 901
1001 IF casilla$(destinox,destinoy)="K" THEN llave=1:SOUND 1,150,10:SOUND 1,50,10
1002 IF casilla$(destinox,destinoy)="C" THEN 1470
1003 IF casilla$(destinox,destinoy)="$" THEN 1560
1020  LOCATE (x*2)-1,(y*2)-1:PRINT borr$
1030  x=destinox:y=destinoy
1040 LOCATE (x*2)-1,(y*2)-1:PRINT guerr$:SOUND 1,4000,1:SOUND 1,4000,1
1041 pasos=pasos-1:IF pasos=0 THEN 2000
1050 GOTO 900
1060  REM
1070  REM DEFINE CUADRICULA DEL MAPA
1080  DIM casilla$(14,13):DIM mapa$(12)
1090  mapa$(1)="*************"
1100  mapa$(2)="*...........*"
1110  mapa$(3)="*...........*"
1120  mapa$(4)="*...........*"
1130  mapa$(5)="*...........*"
1140  mapa$(6)="*...........*"
1150  mapa$(7)="*...........*"
1160  mapa$(8)="*...........*"
1170  mapa$(9)="*...........*"
1180  mapa$(10)="*...........*"
1190  mapa$(11)="*...........*"
1200  mapa$(12)="*************"
1210  FOR casillay=1 TO 12
1220 FOR casillax=1 TO 13
1230 casilla$(casillax,casillay)=MID$(mapa$(casillay),casillax,1)
1240 NEXT casillax
1250 NEXT casillay
1260  REM
1270  REM DECIDE POSICION ALEATORIA DE LA PUERTA Y LA ESTABLECE COMO PUNTO DE ESCAPE
1280  RANDOMIZE TIME: RANDOMIZE RND
1290  pared=INT(RND*4)
1300  IF pared=0 THEN puertay=1:puertax=(INT(RND*11))+2
1310  IF pared=1 THEN puertax=13:puertay=(INT(RND*10))+2
1320 IF pared=2 THEN puertay=12:puertax=(INT(RND*11))+2
1330 IF pared=3 THEN puertax=1:puertay=(INT(RND*10))+2
1340  casilla$(puertax,puertay)="F"
1350 RETURN
1360 REM
1370 REM AVANZAR UNA FASE
1380 LOCATE (x*2)-1, (y*2)-1:PRINT borr$
1390 LOCATE (puertax*2)-1,(puertay*2)-1:PRINT guerr$
1400 ENV 1,5,3,20:SOUND 1,478,0,0,1
1410 FOR espera=1 TO 500:NEXT espera
1420 ERASE casilla$,mapa$
1430 llave=0
1440 planta=planta+1
1450 CLS#2
1460 GOTO 560
1470 REM
1480 REM ABRE COFRE Y GENERA DINERO AL AZAR
1490 botin=INT(RND*99)+1
1500 LOCATE (destinox*2)-1,(destinoy*2)-1:PRINT botin$
1540 casilla$(destinox,destinoy)="$"
1550 GOTO 901
1559 REM
1560 REM COGE EL DINERO
1570 LOCATE (x*2)-1,(y*2)-1:PRINT borr$
1580 LOCATE (destinox*2)-1,(destinoy*2)-1:PRINT guerr$
1581 casilla$(x,y)=".":x=destinox:y=destinoy
1591 FOR espera=1 TO 50:NEXT espera
1920 LOCATE 31,24:PRINT CHR$(15)+CHR$(1);dinero;CHR$(15)+CHR$(3);"+";botin
1930 FOR espera=1 TO 1000:NEXT espera
1940 FOR cuenta=dinero TO (dinero+botin) STEP 2
1950 LOCATE 31,24:PRINT CHR$(15)+CHR$(1);cuenta;CHR$(15)+CHR$(3);"+";botin
1960 SOUND 1,150,1
1970 NEXT cuenta
1980 dinero=dinero+botin:LOCATE 31,24:PRINT CHR$(15)+CHR$(1);dinero;"     ";
1990 GOTO 1041
2000 REM
2001 REM MENU
2002 opcion$(1)="PASAR"
2003 opcion$(2)="MOVER"
2004 opcion$(3)="ATACAR"
2005 opcion$(4)="USAR"
2006 FOR opcion=1 TO 4:PAPER 0:PEN 1:LOCATE 32,opcion+7:PRINT opcion$(opcion):NEXT opcion
2060 LOCATE 30,7:PRINT mano$
2070 opcion=1
2071 LOCATE 30,opcion+6:PRINT mano$
2072 LOCATE 32,opcion+7:PAPER 2:PEN 0:PRINT opcion$(opcion)
2080 a$=INKEY$:IF a$="" THEN 2080
2090 IF a$=CHR$(240) THEN 2140
2100  IF a$=CHR$(241) THEN 2180
2101 IF (a$=" " AND opcion=2) THEN 2250
2130 GOTO 2080
2140 IF opcion=1 THEN 2080
2150 PAPER 0:LOCATE 30,opcion+6:PRINT borr$
2160 PEN 1:PAPER 0:LOCATE 32,opcion+7:PRINT opcion$(opcion)
2170 opcion=opcion-1:GOTO 2071
2180 IF opcion=4 THEN 2080
2190 PAPER 0:LOCATE 30,opcion+6:PRINT borr$
2200 PEN 1:PAPER 0:LOCATE 32,opcion+7:PRINT opcion$(opcion)
2210 opcion=opcion+1:GOTO 2071
2250 WINDOW#3,28,40,7,11:PAPER 1:CLS#3
2260 pasos=5:PAPER 0:GOTO 901
*/ });
