/* globals cpcBasic */

"use strict";

cpcBasic.addItem("", function () { /*
1 rem spaceba - Space Base
2 rem (c) Robin Nixon, 1986
3 rem https://www.cpcwiki.eu/index.php/CWTA_Issue_14_-_February_1986_-_Type-Ins
4 rem
5 rem Modifications: delays
6 rem
100 REM **************************
110 REM *                        *
120 REM *       SPACE BASE       *
130 REM *                        *
140 REM *     By Robin Nixon     *
150 REM *                        *
160 REM * (c) Computing with the *
170 REM *        AMSTRAD         *
180 REM *                        *
190 REM **************************
200 REM
210 SYMBOL AFTER 220:DEFINT A-Z
220 SYMBOL 220,0,60,24,60,60,60,24
230 SYMBOL 221,0,0,58,126,126,58,0,0
240 SYMBOL 222,0,24,60,60,60,24,60,0
250 SYMBOL 223,0,0,92,126,126,92,0,0
260 SYMBOL 230,0,0,0,0,32,16,8,4
270 SYMBOL 231,0,0,0,0,129,66,36,24
280 SYMBOL 232,0,0,0,0,4,8,16,32
290 SYMBOL 233,34,17,15,1,1,15,17,34
300 SYMBOL 234,36,231,60,36,36,60,231,36
310 SYMBOL 235,68,136,240,128,128,240,136,68
320 SYMBOL 236,4,8,16,32,0,0,0,0
330 SYMBOL 237,24,0,0,0,0,0,0,0
340 SYMBOL 238,32,16,8,4,0,0,0,0
350 SYMBOL 240,15,31,63,127,255,255,255,255
360 SYMBOL 241,255,255,255,255,255,255,255,255
370 SYMBOL 242,129,195,231,255,255,255,255,255
380 SYMBOL 243,240,248,252,254,255,255,255,255
390 SYMBOL 244,255,127,63,31,31,63,127,255
400 SYMBOL 245,255,254,252,248,248,252,254,255
410 SYMBOL 246,255,255,255,255,127,63,31,15
420 SYMBOL 247,255,255,255,255,255,231,195,129
430 SYMBOL 248,255,255,255,255,254,252,248,240
440 SYMBOL 249,165,90,165,90,90,165,90,165
450 SYMBOL 250,24,24,60,24,126,24,255,24
460 SYMBOL 251,64,80,84,255,255,84,80,64
470 SYMBOL 252,24,255,24,126,24,60,24,24
480 SYMBOL 253,2,10,42,255,255,42,10,2
490 CALL &BC02:INK 0,0:INK 2,2:BORDER 0:DIM A(5),B(5):HS=2000
500 MODE 1:INK 2,26:SC=0:LV=1:SH=56:PEN 2:PAPER 3:CLS:LOCATE 16,2:PRINT"SPACE BASE"
510 PEN 1:PRINT:PRINT:PRINT"You are the captain of Earth's first"
520 PRINT"space base in the asteroid belt."
530 PRINT:PEN 0:PRINT"Your station acts as a base for mining"
540 PRINT"ships to re-fuel and their crews"
550 PRINT"to rest."
560 PRINT:PEN 2:PRINT"However, hostile alien craft from the"
570 PRINT"Andromeda galaxy are also mining the"
580 PRINT"belt and will stop at nothing to prevent";
590 PRINT"any competition from Earth."
600 PRINT:PEN 1:PRINT"Your task is to defend the base from"
610 PRINT"attack."
620 PRINT:PEN 0:PRINT"Use Z and X to control your lazer and"
630 PRINT"press ENTER to fire."
640 PAPER 2:PEN 0:LOCATE 16,24:PRINT"Press a key";:WHILE INKEY$<>"" OR JOY(0)>0:WEND:WHILE INKEY$="" AND JOY(0)=0:WEND:INK 2,2
650 WHILE SH>-1:MODE 0:PAPER 3:CLS:PEN 2:LOCATE 7,13:PRINT"LEVEL";LV;:FOR Z=1 TO 5000/40:call &bd19:NEXT:MODE 1:PAPER 0:CLS:LZ=40:LZ1=0:LZ2=0:LZC=1:HT=0:ERASE A,B:DIM A(5),B(5)
660 GOSUB 1440:PEN 3:PAPER 2:LOCATE 1,1:PRINT"LAZER";:PEN 1:PAPER 3:LOCATE 33,1:PRINT" SCORE ";:PEN 3:PAPER 1:LOCATE 1,25:PRINT"SHIELDS";:PEN 2:PAPER 1:LOCATE 32,25:PRINT"HI SCORE";:PAPER 1:LOCATE 1,2:PRINT STRING$(5,32);:PAPER 2:LOCATE 1,24
670 PRINT STRING$(7,32);:PEN 2:PAPER 0:LOCATE 33,2:PRINT SC;:PEN 3:LOCATE 32,24:PRINT HS;:FOR Z=57 TO SH+1 STEP -1:MOVE Z*2,16:DRAW Z*2,31,0:NEXT
680 PAPER 0:PEN 1:LOCATE 18,11:PRINT CHR$(240);CHR$(241);CHR$(242);CHR$(241);CHR$(243);
690 LOCATE 18,12:PRINT STRING$(5,241);:LOCATE 18,13:PRINT CHR$(244);STRING$(3,241);CHR$(245);
700 LOCATE 18,14:PRINT STRING$(5,241);:LOCATE 18,15:PRINT CHR$(246);CHR$(241);CHR$(247);CHR$(241);CHR$(248);
710 PEN 2:PAPER 1:LOCATE 19,12:PRINT CHR$(249);:LOCATE 21,12:PRINT CHR$(249);:LOCATE 20,13:PRINT CHR$(249);:LOCATE 19,14:PRINT CHR$(249);:LOCATE 21,14:PRINT CHR$(249);
720 A1$=CHR$(230)+CHR$(231)+CHR$(232):A2$=CHR$(233)+CHR$(234)+CHR$(235):A3$=CHR$(236)+CHR$(237)+CHR$(238)
730 PEN 3:PAPER 0:LOCATE 20,11:PRINT CHR$(242);:LOCATE 18,13:PRINT CHR$(244);:LOCATE 22,13:PRINT CHR$(245);:LOCATE 20,15:PRINT CHR$(247);
740 HT=0:LB=1:IP=0:PEN 3:PAPER 2:GOSUB 1170:PEN 2:GOSUB 1220:PAPER 0
750 WHILE HT<LV*25+25 AND SH>-1
755 t!=time
760 R=RND*(10-LV):IF R<1 THEN GOSUB 890
770 FOR X=1 TO 4:IF B(X)=0 THEN GOTO 780 ELSE GOSUB 1010
780 GOSUB 1400:NEXT
790 GOSUB 1090:R=RND*(10-LV):IF R<1 THEN GOSUB 910
800 IF INKEY(18)=0 OR JOY(0)>15 THEN GOSUB 1280
810 LZ2=LZ2+1:IF LZ2=6 THEN LZ2=0:IF LZ<39 THEN LZ=LZ+1:MOVE LZ*2,368:DRAW LZ*2,382,LZC
820 IF LZ<0 THEN LZ1=1:LZC=3
830 IF LZ1=1 AND LZ>14 THEN PAPER 1:LOCATE 1,2:PRINT STRING$(2,32);:LZC=1:LZ1=0:PAPER 0
835 if time-t!<30 then call &bd19:goto 835
840 WEND:LV=LV+1
850 PEN 2:PAPER 0:FOR Z=SH TO 0 STEP-1:MOVE Z*2,16:DRAW Z*2,31,0:SC=SC+LV:LOCATE 33,2:PRINT SC;:SOUND 1,20,1,7:FOR Z1=1 TO 25:NEXT Z1,Z
860 WEND
870 FOR Z=1 TO 1000:INK RND*3,RND*26:SOUND 1,Z,1,7:NEXT:INK 0,0:INK 1,24:INK 2,2:INK 3,6:MODE 0:PAPER 3:PEN 1:CLS:LOCATE 6,13:PRINT"GAME  OVER";:FOR Z=1 TO 5000:NEXT:IF SC>HS THEN HS=SC
880 GOTO 500
890 R=RND*3+1
900 IF A(R)=0 THEN A(R)=1:PEN 2:FOR Z=500 TO 0 STEP -23:SOUND 1,Z,1,6:NEXT:ON R GOTO 970,980,990,1000
910 R=1:WHILE R<5 AND (A(R)=0 OR B(R)>0):R=R+1:WEND:IF R=5 THEN RETURN
920 FOR Z=200 TO 400 STEP 20:SOUND 1,Z,1,6:NEXT:ON R GOTO 930,940,950,960
930 B(R)=4:RETURN
940 B(R)=36:RETURN
950 B(R)=22:RETURN
960 B(R)=4:RETURN
970 LOCATE 19,1:PRINT A1$;:GOSUB 1400:LOCATE 19,2:PRINT A2$;:GOSUB 1400:LOCATE 19,3:PRINT A3$;:RETURN
980 LOCATE 37,12:PRINT A1$;:GOSUB 1400:LOCATE 37,13:PRINT A2$;:GOSUB 1400:LOCATE 37,14:PRINT A3$;:RETURN
990 LOCATE 19,23:PRINT A1$;:GOSUB 1400:LOCATE 19,24:PRINT A2$;:GOSUB 1400:LOCATE 19,25:PRINT A3$;:RETURN
1000 LOCATE 1,12:PRINT A1$;:GOSUB 1400:LOCATE 1,13:PRINT A2$;:GOSUB 1400:LOCATE 1,14:PRINT A3$;:RETURN
1010 ON X GOTO 1020,1030,1040,1050
1020 LOCATE 20,B(X):GOSUB 1080:IF B(X)+1=11 THEN GOTO 1070 ELSE B(X)=B(X)+1:PEN 3:LOCATE 20,B(X):GOTO 1060
1030 LOCATE B(X),13:GOSUB 1080:IF B(X)-1=22 THEN GOTO 1070 ELSE B(X)=B(X)-1:PEN 3:LOCATE B(X),13:GOTO 1060
1040 LOCATE 20,B(X):GOSUB 1080:IF B(X)-1=15 THEN GOTO 1070 ELSE B(X)=B(X)-1:PEN 3:LOCATE 20,B(X):GOTO 1060
1050 LOCATE B(X),13:GOSUB 1080:IF B(X)+1=18 THEN GOTO 1070 ELSE B(X)=B(X)+1:PEN 3:LOCATE B(X),13
1060 PRINT CHR$(219+X);:RETURN
1070 SOUND 1,0,15,5,0,0,5:FOR Z=0 TO 24 STEP 6:INK 1,Z:INK 2,Z+2:INK 3,Z/6:FOR Z1=1 TO 30/10:call &bd19:NEXT Z1,Z:INK 2,2:INK 3,6:MOVE SH*2,16:DRAW SH*2,30,0:SH%=SH%-1:B(X)=0:PEN 2:GOSUB 1220:RETURN
1080 PEN 0:PRINT" ";:RETURN
1090 GOSUB 1400:IF INKEY(71)=-1 AND INKEY(63)=-1 AND JOY(0)<>4 AND JOY(0)<>8 THEN IP=0:K1=0:K2=0:RETURN
1100 IF IP=1 THEN RETURN
1110 GOSUB 1400
1120 IF K1=0 AND K2=0 THEN RETURN
1130 IP=1:PEN 3:PAPER 0:GOSUB 1170:PEN 0:GOSUB 1220:IF K1=1 THEN LB=LB-1:IF LB=0 THEN LB=4
1140 IF K2=1 THEN LB=LB+1:IF LB=5 THEN LB=1
1150 K1=0:K2=0
1160 PEN 3:PAPER 2:GOSUB 1170:PEN 2:GOSUB 1220:RETURN
1170 ON LB GOTO 1180,1190,1200,1210
1180 LOCATE 20,11:PRINT CHR$(242):RETURN
1190 LOCATE 22,13:PRINT CHR$(245):RETURN
1200 LOCATE 20,15:PRINT CHR$(247):RETURN
1210 LOCATE 18,13:PRINT CHR$(244):RETURN
1220 ON LB GOTO 1230,1240,1250,1260
1230 PAPER 0:LOCATE 20,10:GOTO 1270
1240 PAPER 0:LOCATE 23,13:GOTO 1270
1250 PAPER 0:LOCATE 20,16:GOTO 1270
1260 PAPER 0:LOCATE 17,13:GOTO 1270
1270 PRINT CHR$(249+LB):RETURN
1280 GOSUB 1400:IF LZ1=1 THEN RETURN ELSE MOVE LZ*2,368:DRAW LZ*2,382,0:LZ=LZ-1:FOR Z=30 TO 10 STEP-3:SOUND 1,Z,1,5:NEXT:ON LB GOSUB 1300,1320,1340,1360
1290 PEN 2:GOSUB 1220:RETURN
1300 FOR Z=1 TO 4:GOSUB 1400:MOVE 310,260:DRAW 310,362,Z:NEXT:IF B(LB)>0 THEN SOUND 1,0,20,7,0,0,15:LOCATE 20,B(LB):GOTO 1380
1310 IF A(LB)=0 THEN RETURN ELSE SOUND 1,0,20,7,0,0,1:PEN 0:FOR Z=1 TO 3:LOCATE 19,Z:PRINT"   ";:GOSUB 1400:NEXT:GOTO 1390
1320 FOR Z=1 TO 4:GOSUB 1400:MOVE 370,200:DRAW 580,200,Z:NEXT:IF B(LB)>0 THEN SOUND 1,0,20,7,0,0,15:LOCATE B(LB),13:GOTO 1380
1330 IF A(LB)=0 THEN RETURN ELSE SOUND 1,0,20,7,0,0,1:PEN 0:FOR Z=12 TO 14:LOCATE 37,Z:PRINT"   ";:GOSUB 1400:NEXT:GOTO 1390
1340 FOR Z=1 TO 4:GOSUB 1400:MOVE 310,140:DRAW 310,42,Z:NEXT:IF B(LB)>0 THEN SOUND 1,0,20,7,0,0,15:LOCATE 20,B(LB):GOTO 1380
1350 IF A(LB)=0 THEN RETURN ELSE SOUND 1,0,20,7,0,0,1:PEN 0:FOR Z=23 TO 25:LOCATE 19,Z:PRINT"   ";:GOSUB 1400:NEXT:GOTO 1390
1360 FOR Z=1 TO 4:GOSUB 1400:MOVE 250,200:DRAW 50,200,Z::NEXT:IF B(LB)>0 THEN SOUND 1,0,20,7,0,0,15:LOCATE B(LB),13:GOTO 1380
1370 IF A(LB)=0 THEN RETURN ELSE SOUND 1,0,20,7,0,0,1:PEN 0:FOR Z=12 TO 14:LOCATE 1,Z:PRINT"   ";:GOSUB 1400:NEXT:GOTO 1390
1380 PEN 0:PRINT " ";:B(LB)=0:SC=SC+2*LV:PEN 2:PAPER 0:LOCATE 33,2:PRINT SC;:HT=HT+1:RETURN
1390 A(LB)=0:SC=SC+1*LV:PEN 2:PAPER 0:LOCATE 33,2:PRINT SC;:HT=HT+1:RETURN
1400 call &bd19:IF K1=1 OR K2=1 THEN RETURN
1410 IF JOY(0)=4 THEN K1=1:RETURN
1420 IF JOY(0)=8 THEN K2=1:RETURN
1430 K1=INKEY(71)+1:K2=INKEY(63)+1:RETURN
1440 PAPER 0:CLS:FOR Z=1 TO 500:SOUND 1,500-Z,1,5:PLOT RND*620,RND*400,RND*2+1:NEXT:RETURN
*/ });
